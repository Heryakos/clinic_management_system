<div class="users-container">
    <h2>User Management</h2>
    
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">
      <div class="form-group">
        <label for="username">Username:</label>
        <input 
          type="text" 
          id="username" 
          formControlName="username"
          class="form-control"
          placeholder="Enter username">
        <div class="error-message" *ngIf="userForm.get('username')?.invalid && userForm.get('username')?.touched">
          Username is required
        </div>
      </div>
  
      <div class="form-group">
        <label for="email">Email:</label>
        <input 
          type="email" 
          id="email" 
          formControlName="email"
          class="form-control"
          placeholder="Enter email">
        <div class="error-message" *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched">
          Valid email is required
        </div>
      </div>
  
      <div class="form-group">
        <label for="firstName">First Name:</label>
        <input 
          type="text" 
          id="firstName" 
          formControlName="firstName"
          class="form-control"
          placeholder="Enter first name">
        <div class="error-message" *ngIf="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched">
          First name is required
        </div>
      </div>
  
      <div class="form-group">
        <label for="lastName">Last Name:</label>
        <input 
          type="text" 
          id="lastName" 
          formControlName="lastName"
          class="form-control"
          placeholder="Enter last name">
        <div class="error-message" *ngIf="userForm.get('lastName')?.invalid && userForm.get('lastName')?.touched">
          Last name is required
        </div>
      </div>
  
      <div class="form-group">
        <label for="role">Role:</label>
        <select id="role" formControlName="role" class="form-control">
          <option value="Admin">Admin</option>
          <option value="Doctor">Doctor</option>
          <option value="Nurse">Nurse</option>
          <option value="Pharmacist">Pharmacist</option>
          <option value="Lab_Tech">Lab Technician</option>
          <option value="Receptionist">Receptionist</option>
        </select>
        <div class="error-message" *ngIf="userForm.get('role')?.invalid && userForm.get('role')?.touched">
          Role is required
        </div>
      </div>
  
      <div class="form-group">
        <label for="department">Department:</label>
        <input 
          type="text" 
          id="department" 
          formControlName="department"
          class="form-control"
          placeholder="Enter department (optional)">
      </div>
  
      <div class="form-group checkbox-group">
        <label>
          <input type="checkbox" formControlName="isActive">
          Active
        </label>
      </div>
  
      <button 
        type="submit" 
        class="submit-btn"
        [disabled]="userForm.invalid || isSubmitting">
        {{ isSubmitting ? 'Submitting...' : (editingUserId ? 'Update User' : 'Create User') }}
      </button>
      <button 
        type="button" 
        class="cancel-btn"
        *ngIf="editingUserId"
        (click)="cancelEdit()">
        Cancel
      </button>
    </form>
    <div class="search-container">
      <input 
        type="text" 
        [(ngModel)]="searchText" 
        (ngModelChange)="filterUsers()"
        placeholder="Search by Username, Name, Email, Role, or Department"
        class="search-input">
    </div>
    <div class="users-list">
      <h3>Users</h3>
      <div class="table-container">
        <table class="users-table">
          <thead>
            <tr>
              <th>Username</th>
              <th>Full Name</th>
              <th>Role</th>
              <th>Department</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of filteredUsers">
              <td>{{ user.Username }}</td>
              <td>{{ user.FirstName }} {{ user.LastName }}</td>
              <td>{{ user.Role }}</td>
              <td>{{ user.Department || 'N/A' }}</td>
              <td>
                <span class="status-badge" [ngClass]="user.IsActive ? 'active' : 'inactive'">
                  {{ user.IsActive ? 'Active' : 'Inactive' }}
                </span>
              </td>
              <td>
                <button 
                  class="action-btn edit"
                  (click)="editUser(user)">
                  Edit
                </button>
                <button 
                  class="action-btn delete"
                  (click)="deleteUser(user.UserID)">
                  Delete
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>