<div class="supervisor-container">
    <!-- Summary Cards -->
    <div class="summary-cards">
      <div class="card pending">
        <span class="card-icon">‚è≥</span>
        <div class="card-content">
          <h3>{{ pendingRequestsCount }}</h3>
          <p>Pending Requests</p>
        </div>
      </div>
      <div class="card approved">
        <span class="card-icon">‚úÖ</span>
        <div class="card-content">
          <h3>{{ approvedRequestsCount }}</h3>
          <p>Approved Today</p>
        </div>
      </div>
      <div class="card purchase">
        <span class="card-icon">üõí</span>
        <div class="card-content">
          <h3>{{ purchaseRequestsCount }}</h3>
          <p>Purchase Requests</p>
        </div>
      </div>
      <div class="card value">
        <span class="card-icon">üí∞</span>
        <div class="card-content">
          <h3>{{ totalEstimatedValue | currency:'ETB' }}</h3>
          <p>Pending Value</p>
        </div>
      </div>
    </div>
  
    <!-- Filters -->
    <div class="filters-section">
      <div class="filter-group">
        <label for="statusFilter">Status:</label>
        <select id="statusFilter" [(ngModel)]="statusFilter" (ngModelChange)="onFilterChange()">
          <option value="all">All</option>
          <option value="pending">Pending</option>
          <option value="approved">Approved</option>
          <option value="rejected">Rejected</option>
          <option value="issued">Issued</option>
        </select>
      </div>
      <div class="filter-group">
        <label for="roomFilter">Room:</label>
        <select id="roomFilter" [(ngModel)]="roomFilter" (ngModelChange)="onFilterChange()">
          <option value="all">All</option>
          <option *ngFor="let room of uniqueRooms" [value]="room">{{ room }}</option>
        </select>
      </div>
      <div class="filter-group">
        <label for="dateFrom">From:</label>
        <input type="date" id="dateFrom" [(ngModel)]="dateFrom" (ngModelChange)="onFilterChange()">
        <span>to</span>
        <label for="dateTo">To:</label>
        <input type="date" id="dateTo" [(ngModel)]="dateTo" (ngModelChange)="onFilterChange()">
      </div>
    </div>
  
    <!-- Inventory Requests -->
    <div class="requests-section">
      <h3>Inventory Requests</h3>
      <div class="table-container">
        <table class="requests-table table">
          <thead>
            <tr>
              <th>Request #</th>
              <th>From</th>
              <th>Room</th>
              <th>Date</th>
              <th>Reason</th>
              <th>Status</th>
              <th>Items</th>
              <th>Est. Value</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let request of filteredRequests" [ngClass]="'status-' + request.status.toLowerCase()">
              <td>{{ request.requestNumber }}</td>
              <td>{{ request.requestedByName }}</td>
              <td>
                <span class="room-badge" [ngClass]="getRoomClass(request.roomName)">
                  {{ request.roomName }}
                </span>
              </td>
              <td>{{ request.requestDate | date:'mediumDate' }}</td>
              <td>{{ request.reasonForRequest }}</td>
              <td>
                <span class="status-badge" [ngClass]="'status-' + request.status.toLowerCase()">
                  {{ request.status }}
                </span>
              </td>
              <td>{{ request.itemCount }} <span class="item-count">items</span></td>
              <td>{{ request.estimatedValue | currency:'ETB' }}</td>
              <td class="actions-cell">
                <button type="button" class="action-btn view" (click)="viewRequestDetails(request)">View</button>
                <button type="button" class="action-btn approve" (click)="approveRequest(request)" *ngIf="request.status === 'Pending'">Approve</button>
                <button type="button" class="action-btn reject" (click)="rejectRequest(request)" *ngIf="request.status === 'Pending'">Reject</button>
                <button type="button" class="action-btn issue" (click)="issueItems(request)" *ngIf="request.status === 'Approved'">Issue</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  
    <!-- Purchase Requests -->
    <div class="purchase-requests-section">
      <h3>Purchase Requests</h3>
      <div class="table-container">
        <table class="purchase-table table">
          <thead>
            <tr>
              <th>Purchase #</th>
              <th>Item</th>
              <th>Quantity</th>
              <th>Est. Cost</th>
              <th>Requested By</th>
              <th>Date</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let purchase of purchaseRequests" [ngClass]="'status-' + purchase.status.toLowerCase()">
              <td>{{ purchase.requestNumber }}</td>
              <td>{{ purchase.itemName }} ({{ purchase.itemCode }})</td>
              <td>{{ purchase.quantity }}</td>
              <td>{{ purchase.totalEstimatedCost | currency:'ETB' }}</td>
              <td>{{ purchase.requestedByName }}</td>
              <td>{{ purchase.requestDate | date:'mediumDate' }}</td>
              <td>
                <span class="status-badge" [ngClass]="'status-' + purchase.status.toLowerCase()">
                  {{ purchase.status }}
                </span>
              </td>
              <td class="actions-cell">
                <button type="button" class="action-btn view" (click)="viewPurchaseDetails(purchase)">View</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  
    <!-- Stock Request Form Modal -->
    <app-stock-request-form
      [selectedRequest]="selectedRequest"
      [selectedPurchase]="selectedPurchase"
      [selectedRequestItems]="selectedRequestItems"
      [supervisorName]="supervisorName"
      [showCommentsInput]="showCommentsInput"
      [actionComments]="actionComments"
      [isProcessing]="isProcessing"
      (closeModal)="closeModal()"
      (confirmApproveRequest)="confirmApproveRequest()"
      (confirmRejectRequest)="confirmRejectRequest()"
      (actionCommentsChange)="actionComments = $event"
    ></app-stock-request-form>
  </div>